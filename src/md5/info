This implementation is taken from https://github.com/animetosho/md5-optimisation.